fragment PostFields on ForumPost {
  id
  authorId
  createdAt
  text
  thread {
    id
    authorId
    posts {
      authorId
      createdAt
      text
    }
    categoryId
  }
}

fragment ProposalDiscussionPostFields on ProposalDiscussionPost {
  id
  authorId
  text
  discussionThread {
    id
    proposal {
      id
      creatorId
    }
    posts {
      authorId
      text
    }
  }
}

fragment PostAddedEventFields on PostAddedEvent {
  __typename
  id
  inBlock
  post {
    ...PostFields
  }
}

fragment ThreadCreatedEventFields on ThreadCreatedEvent {
  __typename
  id
  inBlock
  thread {
    id
    categoryId
  }
  text
}

# fragment ProposalDiscussionPostCreatedEventFields on ProposalDiscussionPostCreatedEvent {
#   __typename
#   id
#   inBlock
#   post {
#     ...ProposalDiscussionPostFields
#   }
# }

query GetNotificationEvents($from: Int, $exclude: [ID!]) {
  events(
    where: {
      type_in: [
        PostAddedEvent
        ThreadCreatedEvent
        # PostTextUpdatedEvent
      ]
      inBlock_gte: $from
      NOT: { id_in: $exclude }
    }
    orderBy: [inBlock_ASC]
  ) {
    ... on PostAddedEvent {
      ...PostAddedEventFields
    }
    ... on ThreadCreatedEvent {
      ...ThreadCreatedEventFields
    }
    # ... on ProposalDiscussionPostCreatedEvent {
    #   ...ProposalDiscussionPostCreatedEventFields
    # }
  }
}
